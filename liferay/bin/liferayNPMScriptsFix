#!/bin/bash

(
flock 200 || exit 1
echo $1

cp ~/Projects/community-portal/liferay-portal/modules/.eslintignore ~/Projects/community-portal/liferay-portal/modules/.eslintignore.bak
echo "" >> ~/Projects/community-portal/liferay-portal/modules/.eslintignore
echo "*.js" >> ~/Projects/community-portal/liferay-portal/modules/.eslintignore
echo "*.d.ts" >> ~/Projects/community-portal/liferay-portal/modules/.eslintignore
echo "*.jsp" >> ~/Projects/community-portal/liferay-portal/modules/.eslintignore
echo "*.scss" >> ~/Projects/community-portal/liferay-portal/modules/.eslintignore
echo "!$1" >> ~/Projects/community-portal/liferay-portal/modules/.eslintignore
cp ~/Projects/community-portal/liferay-portal/modules/.prettierignore ~/Projects/community-portal/liferay-portal/modules/.prettierignore.bak
echo "" >> ~/Projects/community-portal/liferay-portal/modules/.prettierignore
echo "*.js" >> ~/Projects/community-portal/liferay-portal/modules/.prettierignore
echo "*.d.ts" >> ~/Projects/community-portal/liferay-portal/modules/.prettierignore
echo "*.jsp" >> ~/Projects/community-portal/liferay-portal/modules/.prettierignore
echo "*.scss" >> ~/Projects/community-portal/liferay-portal/modules/.prettierignore
echo "!$1" >> ~/Projects/community-portal/liferay-portal/modules/.prettierignore

~/Projects/community-portal/liferay-portal/modules/node_modules/.bin/liferay-npm-scripts fix

mv ~/Projects/community-portal/liferay-portal/modules/.eslintignore.bak ~/Projects/community-portal/liferay-portal/modules/.eslintignore
mv ~/Projects/community-portal/liferay-portal/modules/.prettierignore.bak ~/Projects/community-portal/liferay-portal/modules/.prettierignore
) 200>/tmp/liferayNPMScriptsFix.lockfile
